"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7926],{7926:(b,p,a)=>{a.r(p),a.d(p,{TransferEpinPageModule:()=>P});var c=a(177),d=a(4341),t=a(1075),u=a(8986),T=a(467),e=a(4438),m=a(8793),g=a(5880);function h(n,i){if(1&n&&(e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.k0s()()),2&n){const o=e.XpG();e.R7$(2),e.SpI(" Transfer To Name: ",o.newUser.name," ")}}function E(n,i){1&n&&(e.j41(0,"span"),e.EFF(1,"Transfer Epin"),e.k0s())}function C(n,i){1&n&&e.nrm(0,"ion-spinner",8)}let M=(()=>{var n;class i{constructor(r,s,l){this.modalCtrl=r,this.userDataService=s,this.epinService=l,this.referralCode="",this.users=[],this.selectedUser=null,this.transferringEpin=!1,this.newUser=null}validateReferral(){this.referralCode&&this.userDataService.getUserByReferralCode(this.selectedUser).subscribe(r=>{this.newUser=r},r=>{console.error("Invalid Referral:",r)})}selectUser(r){this.selectedUser=r}transfer(){const r=JSON.parse(localStorage.getItem("user")||"{}");console.log("Transferring epin to:",this.selectedUser),this.selectedUser!==r.id?(console.log("transfer by ",r.id),console.log([this.referralCode]),this.epinService.transferEpin({ePinIds:[this.referralCode],userId:r.id,transferredToId:this.newUser.id}).subscribe(s=>{alert("Epin transferred successfully"),this.modalCtrl.dismiss(),console.log(s)},s=>{console.error(s)})):alert("You cannot transfer epin to yourself")}dismissModal(){this.modalCtrl.dismiss()}}return(n=i).\u0275fac=function(r){return new(r||n)(e.rXU(t.W3),e.rXU(m.J),e.rXU(g.u))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-transfer-modal"]],inputs:{referralCode:"referralCode"},decls:19,vars:5,consts:[["slot","end"],[3,"click"],[3,"ngModelChange","ngModel"],["expand","full",3,"click"],[4,"ngIf"],[1,"ion-padding"],["expand","block",3,"click","disabled"],["name","crescent",4,"ngIf"],["name","crescent"]],template:function(r,s){1&r&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Transfer Epin"),e.k0s(),e.j41(4,"ion-buttons",0)(5,"ion-button",1),e.bIt("click",function(){return s.dismissModal()}),e.EFF(6,"Close"),e.k0s()()()(),e.j41(7,"ion-content")(8,"ion-list")(9,"ion-list-header"),e.EFF(10,"Select User"),e.k0s(),e.j41(11,"ion-input",2),e.mxI("ngModelChange",function(f){return e.DH7(s.selectedUser,f)||(s.selectedUser=f),f}),e.k0s(),e.j41(12,"ion-button",3),e.bIt("click",function(){return s.validateReferral()}),e.EFF(13,"Validate Referral"),e.k0s(),e.DNE(14,h,3,1,"ion-item",4),e.k0s(),e.j41(15,"div",5)(16,"ion-button",6),e.bIt("click",function(){return s.transfer()}),e.DNE(17,E,2,0,"span",4)(18,C,1,0,"ion-spinner",7),e.k0s()()()),2&r&&(e.R7$(11),e.R50("ngModel",s.selectedUser),e.R7$(3),e.Y8G("ngIf",s.newUser),e.R7$(2),e.Y8G("disabled",!s.selectedUser||s.transferringEpin),e.R7$(),e.Y8G("ngIf",!s.transferringEpin),e.R7$(),e.Y8G("ngIf",s.transferringEpin))},dependencies:[c.bT,d.BC,d.vS,t.Jm,t.QW,t.W9,t.eU,t.$w,t.uz,t.he,t.nf,t.AF,t.w2,t.BC,t.ai,t.Gw]}),i})();function U(n,i){if(1&n){const o=e.RV6();e.j41(0,"ion-item")(1,"ion-label"),e.EFF(2),e.j41(3,"ion-button",5),e.bIt("click",function(){const s=e.eBV(o).$implicit,l=e.XpG();return e.Njj(l.openTransferModal(s.id))}),e.EFF(4,"Transfer"),e.k0s()()()}if(2&n){const o=i.$implicit;e.R7$(2),e.SpI(" Code: ",o.code," ")}}const v=[{path:"",component:(()=>{var n;class i{constructor(r,s,l){this.epinService=r,this.userDataService=s,this.modalCtrl=l,this.user=JSON.parse(localStorage.getItem("user")||"{}"),this.unusedEPins=[],this.showModal=!1}ngOnInit(){this.loadUnusedEPins(this.user.id)}loadUnusedEPins(r){this.epinService.getUnusedEPinReport(r).subscribe({next:s=>{this.unusedEPins=s.data},error:s=>{console.error("There was an error!",s)}})}openTransferModal(r){var s=this;return(0,T.A)(function*(){return yield(yield s.modalCtrl.create({component:M,componentProps:{referralCode:r}})).present()})()}}return(n=i).\u0275fac=function(r){return new(r||n)(e.rXU(g.u),e.rXU(m.J),e.rXU(t.W3))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-transfer-epin"]],decls:11,vars:3,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(r,s){1&r&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"TransferEpin"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),e.EFF(8,"TransferEpin"),e.k0s()()(),e.j41(9,"ion-list"),e.DNE(10,U,5,1,"ion-item",4),e.k0s()()),2&r&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(6),e.Y8G("ngForOf",s.unusedEPins))},dependencies:[c.Sq,t.Jm,t.W9,t.eU,t.uz,t.he,t.nf,t.BC,t.ai]}),i})()}];let F=(()=>{var n;class i{}return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[u.iI.forChild(v),u.iI]}),i})(),P=(()=>{var n;class i{}return(n=i).\u0275fac=function(r){return new(r||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[c.MD,d.YN,t.bv,F]}),i})()}}]);